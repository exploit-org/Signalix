package org.exploit.signalix.serializer;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.module.SimpleModule;
import org.exploit.signalix.marker.Event;

public class EventModule extends SimpleModule {
    private final EventSerializer serializer;
    private final EventDeserializer deserializer;

    public EventModule(ObjectMapper objectMapper) {
        this.serializer = new EventSerializer(objectMapper);
        this.deserializer = new EventDeserializer();

        init();
    }

    public EventModule addEvent(Class<? extends Event> clazz) {
        deserializer.addEvent(clazz);
        return this;
    }

    public EventModule removeEvent(Class<? extends Event> clazz) {
        deserializer.removeEvent(clazz);
        return this;
    }

    private void init() {
        addSerializer(serializer).addDeserializer(Event.class, deserializer);
    }
}
